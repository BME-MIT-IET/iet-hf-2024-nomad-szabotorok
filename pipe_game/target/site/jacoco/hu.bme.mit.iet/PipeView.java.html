<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PipeView.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">pipe_game</a> &gt; <a href="index.source.html" class="el_package">hu.bme.mit.iet</a> &gt; <span class="el_source">PipeView.java</span></div><h1>PipeView.java</h1><pre class="source lang-java linenums">package hu.bme.mit.iet;
import javax.sound.sampled.Line;
import javax.swing.*;
import javax.swing.border.CompoundBorder;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.geom.Line2D;
import java.util.ArrayList;

import static java.lang.Math.sqrt;

public class PipeView extends ViewBase {
    private Pipe pipe;
    private JButton button;
    private JLabel nev;

    /**
     * Konstruktor, ami létrehozza az osztály grafikus megjelenéséhez szükséges swing elemeket
     * @param view
     * @param pipe
     */
    public PipeView(View view, Pipe pipe){
<span class="nc" id="L24">        super(view);</span>
<span class="nc" id="L25">        this.pipe = pipe;</span>
<span class="nc" id="L26">        button = new JButton();</span>
<span class="nc" id="L27">        button.addActionListener(this);</span>
<span class="nc" id="L28">        nev = new JLabel();</span>
<span class="nc" id="L29">    }</span>

    /**
     * A példány jelenlegi állapotához kötődő grafikus frissítés
     * effectek beállítása
     * játékosok helyes feltétele a jelenlegi állapotnak megfelelően
     */
    @Override
    public void Update() {
<span class="nc" id="L38">        button.setBounds(x, y, 50, 50);</span>
<span class="nc" id="L39">        button.setBackground(Color.LIGHT_GRAY);</span>
<span class="nc" id="L40">        button.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 10));</span>
<span class="nc" id="L41">        button.setMargin(new Insets(0,0,0,0));</span>
<span class="nc" id="L42">        view.getPanel().remove(button);</span>

<span class="nc bnc" id="L44" title="All 4 branches missed.">        if (pipe.isBroken() &amp;&amp; pipe.isSlippery())</span>
<span class="nc" id="L45">            button.setBorder(new CompoundBorder(BorderFactory.createMatteBorder(3, 3, 0, 0, new Color(80, 238, 238,255)), BorderFactory.createMatteBorder(0, 0, 3, 3, new Color(255, 140, 0,255))));</span>
<span class="nc bnc" id="L46" title="All 4 branches missed.">        else if (pipe.isBroken() &amp;&amp; pipe.isGlued())</span>
<span class="nc" id="L47">            button.setBorder(new CompoundBorder(BorderFactory.createMatteBorder(3, 3, 0, 0, new Color(50, 96, 21,255)), BorderFactory.createMatteBorder(0, 0, 3, 3, new Color(255, 140, 0,255))));</span>
<span class="nc bnc" id="L48" title="All 2 branches missed.">        else if(pipe.isBroken())</span>
<span class="nc" id="L49">            button.setBorder(BorderFactory.createLineBorder(new Color(255, 140, 0,255),3));</span>
<span class="nc bnc" id="L50" title="All 2 branches missed.">        else if (pipe.isSlippery())</span>
<span class="nc" id="L51">            button.setBorder(BorderFactory.createLineBorder(new Color(80, 238, 238,255),3));</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">        else if (pipe.isGlued())</span>
<span class="nc" id="L53">            button.setBorder(BorderFactory.createLineBorder(new Color(50, 96, 21,255),3));</span>
        else {
<span class="nc" id="L55">            button.setBorder(BorderFactory.createLineBorder(Color.BLACK, 1));</span>
        }

<span class="nc" id="L58">        view.getPanel().remove(nev);</span>
<span class="nc bnc" id="L59" title="All 2 branches missed.">        if (pipe.players.size() == 0)</span>
<span class="nc" id="L60">            button.setText(pipe.getId());</span>
        else {
<span class="nc" id="L62">            button.setText(pipe.getId());</span>
<span class="nc" id="L63">            nev = new JLabel(pipe.players.get(0).getId());</span>
<span class="nc" id="L64">            nev.setFont(new Font(&quot;Arial&quot;, Font.BOLD, 10));</span>
<span class="nc" id="L65">            nev.setBounds(x+14, y+2, 20, 20);</span>
<span class="nc" id="L66">            view.getPanel().add(nev, Integer.valueOf(2));</span>
        }
<span class="nc" id="L68">        view.getPanel().add(button, Integer.valueOf(1));</span>

        /**
         * Vonalak es nyilak kirajzolasa
         */
<span class="nc" id="L73">        ArrayList&lt;ViewBase&gt; fields = view.getFields();</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        for (int i = 0; i &lt; pipe.neighbours.size(); ++i){</span>
<span class="nc" id="L75">            String id = pipe.getNeighbours().get(i).getId();</span>
<span class="nc bnc" id="L76" title="All 2 branches missed.">            for (ViewBase f: fields) {</span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">                if (id.equals(f.getID())){</span>
<span class="nc" id="L78">                    int vX = x-f.getX();</span>
<span class="nc" id="L79">                    int vY = y-f.getY();</span>
<span class="nc" id="L80">                    double hossz = sqrt((x-f.getX())*(x-f.getX())+(y-f.getY())*(y-f.getY()));</span>
<span class="nc" id="L81">                    int eX = (int) ((vX/hossz)*26);</span>
<span class="nc" id="L82">                    int eY = (int) ((vY/hossz)*26);</span>
<span class="nc" id="L83">                    Line2D line = new Line2D.Float(x+25-eX,y+25-eY,f.getX()+25+eX,f.getY()+25+eY);</span>
<span class="nc" id="L84">                    view.addLine(line);</span>

<span class="nc" id="L86">                    String[] splitted = id.split(&quot; &quot;);</span>
<span class="nc bnc" id="L87" title="All 2 branches missed.">                    if (splitted[0].equals(&quot;pump&quot;)) {</span>
<span class="nc" id="L88">                        SystemPart pump = pipe.getNeighbours().get(i);</span>

<span class="nc bnc" id="L90" title="All 4 branches missed.">                        if (pump.getFrom() != null &amp;&amp; pump.getFrom().equals(pipe.getId())) {</span>
<span class="nc" id="L91">                            Line2D lineend1 = new Line2D.Float(f.getX() + 25 + eX, f.getY() + 25 + eY, f.getX() + 25 + 2 * eX - eY / 2, f.getY() + 25 + 2 * eY + eX / 2);</span>
<span class="nc" id="L92">                            Line2D lineend2 = new Line2D.Float(f.getX() + 25 + 2 * eX + eY / 2, f.getY() + 25 + 2 * eY - eX / 2, f.getX() + 25 + eX, f.getY() + 25 + eY);</span>
<span class="nc" id="L93">                            view.addLine(lineend1);</span>
<span class="nc" id="L94">                            view.addLine(lineend2);</span>
<span class="nc" id="L95">                        }</span>
<span class="nc bnc" id="L96" title="All 4 branches missed.">                        else if (pump.getTo() != null &amp;&amp; pump.getTo().equals(pipe.getId())) {</span>
<span class="nc" id="L97">                            Line2D lineend1 = new Line2D.Float(x + 25 - eX, y + 25 - eY, x+ 25 - 2 * eX - eY / 2, y+ 25 - 2 * eY + eX / 2);</span>
<span class="nc" id="L98">                            Line2D lineend2 = new Line2D.Float(x + 25 - 2 * eX + eY / 2, y + 25 - 2 * eY - eX / 2, x + 25 - eX, y + 25 - eY);</span>
<span class="nc" id="L99">                            view.addLine(lineend1);</span>
<span class="nc" id="L100">                            view.addLine(lineend2);</span>
                        }
                    }
                }
            }
        }
<span class="nc" id="L106">    }</span>

    /**
     * ActionListener interface megvalósítása
     * @param e the event to be processed
     */
    public void actionPerformed(ActionEvent e){
<span class="nc" id="L113">       action(pipe.getId());</span>
<span class="nc" id="L114">    }</span>

    /**
     * getter függvény
     * @return
     */
    @Override
    public String getID(){
<span class="nc" id="L122">        return pipe.getId();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>